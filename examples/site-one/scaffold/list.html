[%- USE date(format = '%a, %d-%b-%Y') -%]
[%- WRAPPER site_wrapper.html 
  title = 'List'
-%]
[%- SET 
 p      = c.req.query_params
 result = list_posts( p )
 posts  = result.rows
-%]

  <div class="blog-post">
  
  <div style="padding-bottom:5px;">
  <h3>
    [% IF p.search %]
      Posts containing "[% p.search %]"
        [% IF p.tag %] and [% END %]
    [% END %]
    [% IF p.tag %]Tagged "[% p.tag %]" [% END %]
  </h3>
  <h4>
    [% IF result.total > 0 %]
      [% result.start %] - [% result.end %] of [% result.total %] posts:
    [% ELSE %]
      No posts found.
    [% END %]
  </h4>
  
  <div>
    [% IF result.first_qs %]
      <a style="padding-left:15px;" href="?[% result.first_qs %]" alt="First Page"><b>&lt;&lt;</b></a>
    [% END %]
    [% IF result.prev_qs %]
      <a style="padding-left:15px;" href="?[% result.prev_qs %]" alt="Previous Page"><b>&lt;</b></a>
    [% END %]
    [% IF result.next_qs %]
      <a style="padding-left:35px;" href="?[% result.next_qs %]" alt="Next Page"><b>&gt;</b></a>
    [% END %]
    [% IF result.last_qs %]
      <a style="padding-left:15px;" href="?[% result.last_qs %]" alt="Last Page"><b>&gt;&gt;</b></a>
    [% END %]
  </div>
  
  
  
  </div>
    <ul>
      [% FOREACH Post IN posts %]
        <li>
          <a href="../post/[% Post.name %]">[% Post.title %]</a> 
          <i style="padding-left:3px;opacity:0.6;font-size:.9em;"> [% date.format(Post.ts) %]</i>
          
          <div style="font-size:0.7em;padding: 5px 0px 15px 5px;">
            [% Post.summary %] ... <a href="../post/[% Post.name %]">read more</a> 
          </div>
          
        </li>
      [% END %]
    </ul>
  
  </div>

[% END %]